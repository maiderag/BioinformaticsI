def Probablekmer(P, kmer):
    p = 1
    for i in range(len(kmer)):
        if kmer[i] == 'A':
            p = p*P[0][i]
        elif kmer[i] == 'C':
            p = p*P[1][i]
        elif kmer[i] == 'G':
            p = p*P[2][i]
        elif kmer[i] == 'T':
            p = p*P[3][i]
    return p 

#print(Probablekmer([[0.2,0.2,0,0,0,0,0.9,0.1,0.1,0.1,0.3,0],[0.1,0.6,0,0,0,0,0,0.4,0.1,0.2,0.4,0.6],[0,0,1,1,0.9,0.9,0.1,0,0,0,0,0],[0.7,0.2,0,0,0.1,0.1,0,0.5,0.8,0.7,0.3,0.4]],'TCGGGGATTTCC'))

def ProfilemostProbable(Text, k, P):
    mostp = 0 
    for i in range(len(Text)-k+1):
        kmer = Text[i:i+k]
        p = Probablekmer(P, kmer)
        if p>mostp:
            mostp = p
            mostprobkmer = kmer
    return mostprobkmer

#print(ProfilemostProbable('ACCTGTTTATTGCCTAAGTTCCGAACAAACCCAATATAGCCCGAGGGCCT',5,[[0.2,0.2,0.3,0.2,0.3],[0.4,0.3,0.1,0.5,0.1],[0.3,0.3,0.5,0.2,0.4],[0.1,0.2,0.1,0.1,0.2]]))

print(ProfilemostProbable('TCCATGTTTAATAAGCTCATCGCGGAGACGTCTCGTTCAAGCAGACAGGCATTTCTCCTCTCTCCACCACCGTAGCTAACGGCACAATAGACTACGTCCTTGTCGTCAGATCCACCTAACCTGATAGTAAAACCTAATGATCTTATAAAGGGATCGTAAGCCATGCATTATAGTAGAAGGTACAAGTTAGGGCCTTCGGCCTGAAATCGGGTCTGTGCGGTGTAAGCAAGACCTCATTGAGGTGAAGGTTGCTAACCTGTCGCAAATTAATCTGTGTGCGACTGGAGATTTTCGTGCGTAGAATTGCACACAATTGTACCTCGGCGGCTGCGGTGGAGGTCATAGTTATCTGGCCTCTTCTCAGGTGTATCGTACCTTTAGTAAAACCCGCTAAACGTCGAGACATTGCCGCGGTCGAAGACTGATGCATCCGTGAGTACCCTAGATAAGGCGGACTATTCTTTTACCGAATAGGGCCAGGAGTCCCTGGATCTTTCCATGTGTCGGTATGAGTAAAGAAAAAAAGGCTCGGCCTAGGGAACGACGCCGAAGTATGAGTGGCTCCTGGCTAAGTTTGTTACATCATTTGCGTATCGTGGTGCTGACGTTCGACCACATAGGGTTCTCAGTTCTACCTTTGATAGAATGTATGCCCAAGCAAGGTCGGTCATCGTTCGTCACTTGCACGTCTGAATCGGCGAGGGTGATCAAAGTTATTATACCGGTGCATAAGTTGACAAAACAGAGCGGACTTTCTTAACCATAGGCCGGCGTCGGTTGATATGTTATCTATCGGGCCGCGCAGAAGTCGCCCTTAAAGCGCCCCGCTATAATGGAACACAATGCGTTTTCAAATGGGAACCGTGGGCTATTCGTCCATTTGAACTAGCAACTAAAAAAGTGTGTAGTGTGGCCCTCTCCTTTTTTTTGTCCTCCAGGGGGCCCATAGGCTCACTTATCTGCTATACTGTCTATGAATCCAGGGGATTTGCCAGTTGAC',15,[[0.273 ,0.273, 0.394, 0.242, 0.212, 0.258, 0.303, 0.348, 0.242, 0.197, 0.348, 0.303, 0.303, 0.258, 0.258],[0.303, 0.197, 0.152, 0.227, 0.258, 0.318, 0.258, 0.227, 0.242, 0.242, 0.182, 0.167, 0.227, 0.318, 0.212],[0.167 ,0.242 ,0.212, 0.227, 0.318, 0.197, 0.227, 0.227, 0.242, 0.227, 0.227, 0.273, 0.303, 0.212, 0.303],[0.258 ,0.288 ,0.242, 0.303, 0.212, 0.227, 0.212, 0.197, 0.273, 0.333, 0.242, 0.258, 0.167, 0.212, 0.227]]))


